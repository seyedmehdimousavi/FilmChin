<!DOCTYPE html>
<html lang="fa" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FilmChiin</title>
  <!-- Bootstrap icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <!-- main stylesheet -->
  <link rel="stylesheet" href="style.css">

  <!-- supabase client -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="index-body">
<!-- Toast Container -->
<div id="toast-container"></div>
<!-- Active Filters Toast -->
<div id="activeFilters" class="active-filters-toast"></div>
<!-- Header (sticky with blur) -->

<header class="main-header">
  <!-- ğŸ”¹ Ø¨Ù†Ø± Ø¨Ø§Ù„Ø§ÛŒ Ø³Ø§ÛŒØª -->
<div class="site-banner">
  <div class="banner-content">
    <span class="banner-logo">
      <img src="/images/banner-icon.png" alt="banner-logo" />
    </span>
    <span class="banner-text">filmchiin.ir</span>
  </div>
</div>
<div class="header">
<div class="search-bar">
  <button id="menuBtn" class="menu-btn" aria-label="menu">
    <img width="96" height="96" src="images/icons8-menu-64.png" alt="menu--v2" style="display:flex;align-items:center;"/>
  </button> 
  <!-- Ù…Ù†ÙˆÛŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø¨Ø¹Ø¯ Ø§Ø² Ù„Ø§Ú¯ÛŒÙ† -->
<div id="profileMenu" class="profile-menu hidden">
  <div class="profile-bubble">
    <div class="profile-username" id="profileUsername">UserName</div>
    <button class="profile-edit">ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø´Ø®ØµØ§Øª</button>
    <hr class="profile-divider"/>
    <button id="logoutBtn" class="profile-logout">Logout</button>
  </div>
</div>


  <input id="search" type="text" placeholder="Search..." dir="auto"/>

  <!-- Ø¯Ú©Ù…Ù‡ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ (Ø¨Ø§ Ø§Ø³ØªØ§ÛŒÙ„ icon-inside Ùˆ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø±ÛŒÙ†Ú¯ Ø®ÙˆØ¯Ø´) -->
  <button id="profileBtn" class="icon-inside" style="display:flex;align-items:center;" aria-label="profile">
    <img src="images/icons8-user-96.png" alt="user"/>
    <span id="commentBadge" class="badge" style="display:none;">!</span>
  </button>

  <!-- Ø¯Ú©Ù…Ù‡ close Ø³Ø§Ø¯Ù‡ (Ø¨Ø¯ÙˆÙ† Ú©Ù„Ø§Ø³ icon-inside) -->
  <button id="searchCloseBtn" class="close-btn" style="display:none;" aria-label="close">âœ•</button>
</div>
    <button id="themeToggle" class="icon-btn" aria-label="toggle theme" style="display: flex;align-items: center;"><img src="images/icons8-moon.apng" alt="bright-moon"/></button>
</div>
    
</header>

<!-- side menu and overlay -->
<div id="menuOverlay" class="menu-overlay"></div>


<nav id="sideMenu" class="side-menu" aria-hidden="true">
  
  <div class="menu-section">
    
     <div class="gs">
        <div id="genreToggle" class="menu-toggle">
           <i class="bi bi-list"></i> Genres
        </div>
        <div id="genreSubmenu" class="submenu" style="display:none;">
           <div id="genreGrid" class="genre-grid"></div>
         </div>
     </div>
     <div class="sl">
       <div id="linksHeader">
         <div class="links-toggle" style="display: flex;align-items: center;">
           <i class="bi bi-link-45deg"></i> Links
         </div>
           <i class="bi bi-chevron-down toggle-icon links-toggle"></i>
       </div>
        <div id="socialGrid" class="social-grid hidden"></div>
  </div>
  <div id="ratingFilter" class="rating-filter">
  <h4 class="rating-filter-title">Sort by imdb rating</h4>

  <div class="rating-process-wrapper">
    <div class="rating-min">0</div>
    <div class="rating-track" id="ratingTrack" aria-hidden="false">
      <div class="rating-track-fill" id="ratingFill"></div>
      <div class="rating-knob" id="ratingKnob" role="slider" tabindex="0" aria-valuemin="0" aria-valuemax="10" aria-valuenow="0">
        <div class="rating-bubble" id="ratingBubble" aria-hidden="true">
          Rating &gt; <span id="ratingBubbleValue">0.0</span>
        </div>
      </div>
    </div>
    <div class="rating-max">10</div>
  </div>

  <div class="rating-controls">
    <button id="applyRatingFilter" class="btn small">Apply</button>
  </div>
</div>
</div>

<section class="side-menu-bottom">
  <!-- Message to admin bubble -->
<div id="chatBubble" class="chat-bubble">
  <div class="chat-bubble-header">
    <span class="chat-bubble-title">Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ø§Ø¯Ù…ÛŒÙ†</span>
    <span id="chatBubbleBadge" class="badge" style="display:none;">!</span>
  </div>

  <!-- Ø±Ø¯ÛŒÙ Ø¬Ù…Ø¹â€ŒØ´Ø¯Ù‡ (Ú©Ø§Ù„Ù¾Ø³) -->
  <div class="chat-input-row" id="chatInputRow">
    <input id="chatInput" type="text" placeholder="Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ø§Ø¯Ù…ÛŒÙ†" />
    <div class="chat-actions">
      <button id="chatAttachBtn" class="chat-icon-btn" aria-label="attach">
        <img src="images/icons8-attach-60.png" alt="attach" />
      </button>
      <input id="chatAttachFile" type="file" accept="image/*" hidden />
      <button id="chatSendBtn" class="chat-icon-btn disabled" aria-label="send">
        <img src="images/icons8-send-90.png" alt="send" />
      </button>
    </div>
  </div>

  <!-- Ù†Ù…Ø§ÛŒ ØªÙ…Ø§Ù…â€ŒØµÙØ­Ù‡ Ø¯Ø± Ø³Ø§ÛŒØ¯Ù…Ù†Ùˆ -->
  <div id="chatOverlay" class="chat-overlay" aria-hidden="true">
    <div class="chat-overlay-header">
      <button id="userChatBackBtn" class="chat-back-btn" aria-label="back">close</button>
      <img id="chatAdminAvatar" class="chat-admin-avatar" src="images/Admin-logo.png" alt="admin" />
      <div class="chat-overlay-title">Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ø§Ø¯Ù…ÛŒÙ†</div>
    </div>

    <div id="chatMessagesList" class="chat-messages-list"></div>

    <!-- Ú©Ø§Ù…Ù¾ÙˆØ²Ø± Ù¾Ø§ÛŒÛŒÙ† -->
    <div class="chat-composer">
      <button id="overlayAttachBtn" class="chat-icon-btn" aria-label="attach">
        <img src="images/icons8-attach-60.png" alt="attach" />
      </button>
      <input id="overlayAttachFile" type="file" accept="image/*" hidden />
      <input id="overlayInput" type="text" placeholder="Ø¨Ù†ÙˆÛŒØ³..." />
      <button id="overlaySendBtn" class="chat-icon-btn disabled" aria-label="send">
        <img src="images/icons8-send-90.png" alt="send" />
      </button>
    </div>
  </div>
</div>

<div class="designer-credit">
  Design :
  <div style="display: flex;align-items: center; justify-content: space-between; gap: 4px;">
    <a href="tg://resolve?domain=SeyedMahdiMousavi" target="_blank" class="designer-bubble">Mehdi</a>
  <div id="appVersion" class="genre-chip version-chip">v1.0.0</div>
  </div>
</div>
</section>

</nav>


<section class="movie-type-tabs">
  <button data-type="all" class="active">All Movies <span class="count">0</span></button>
  <button data-type="collection">Collections <span class="count">0</span></button>
  <button data-type="series">Series <span class="count">0</span></button>
  <button data-type="single">Single Films <span class="count">0</span></button>
</section>
<div class="tab-genres-wrapper">
  <div class="tab-genres-list"></div>
</div>

<!-- main container -->
<div class="container">
  <!-- admin messages (bubbles above movies) -->
  <div id="adminMessages" class="messages-container" aria-live="polite"></div>
 
  
  <section id="popular-carousel" class="popular-section">
  <h2>ÙÛŒÙ„Ù…â€ŒÙ‡Ø§ÛŒ Ù¾Ø±Ø·Ø±ÙØ¯Ø§Ø±</h2>
  <div class="carousel-container">
    <button class="carousel-btn prev"><img src="images/icons8-back-to-64.png" alt="prev button" /></button>
    <div class="carousel-window">
      <div class="carousel-track"></div>
    </div>
    <button class="carousel-btn next"><img src="images/icons8-next-page-64.png" alt="next button" /></button>
  </div>
  <div class="carousel-bg"></div>
</section>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒØ´ØªØ± -->
<div id="movie-modal" class="movie-modal">
  <div class="movie-modal-content"></div>
</div>

  <!-- movies count -->
  <div id="movieCount" class="movie-count">Number of movies: 0</div>
  
  <!-- movies grid -->
  <div id="moviesGrid" class="movies-grid" role="list"></div>

  <!-- pagination -->
  <div id="pagination" class="pagination-container" aria-label="pagination"></div>
</div>

<!-- Auth Modal -->
<div id="authModal" class="login-modal" aria-hidden="true">
  <div class="login-box">
    <!-- ØªØ¨â€ŒÙ‡Ø§ -->
    <div class="auth-tabs">
      <button class="tab-btn active" data-tab="login">Login</button>
      <button class="tab-btn" data-tab="signup">Sign Up</button>
    </div>

    <!-- ÙØ±Ù… Ù„Ø§Ú¯ÛŒÙ† -->
    <form id="loginForm" class="tab-content active" data-tab="login">
      <input type="text" id="loginUsername" placeholder="Gmail or Username" required />
      <input type="password" id="loginPassword" placeholder="Password" required />
      <button type="submit" class="login-btn">Login</button>
    </form>

    <!-- ÙØ±Ù… Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø¯Ùˆ Ù…Ø±Ø­Ù„Ù‡â€ŒØ§ÛŒ -->
    <form id="signupForm" class="tab-content" data-tab="signup" enctype="multipart/form-data">
      <!-- Ù…Ø±Ø­Ù„Ù‡ Û± -->
      <div id="signupStep1" class="fade-step active-step">
        <input type="email" id="signupEmail" placeholder="Gmail" required />
        <input type="text" id="signupUsername" placeholder="Username" required />
        <input type="password" id="signupPassword" placeholder="Password" required />
      </div>

      <!-- Ù…Ø±Ø­Ù„Ù‡ Û² -->
      <div id="signupStep2" class="fade-step" style="display:none;">
        <input type="file" id="signupAvatar" accept="image/*" required />
        <small style="font-size:12px;color:#888;">Ø­Ø¯Ø§Ú©Ø«Ø± Ø­Ø¬Ù… Ø¹Ú©Ø³: 500KB</small>
      </div>

      <button type="button" id="signupNextBtn" class="login-btn signup-next-btn">
  <img src="/images/icons8-next.apng" alt="next" id="signupNextIcon" style="height:22px;vertical-align:middle;">
  <span id="signupBtnText"></span>
</button>
    </form>
  </div>
</div>


<!-- Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø´Ù†Ø§ÙˆØ± -->
<div class="floating-wrapper">
  <!-- Ù¾Ù†Ù„ Ø§Ø³ØªÙˆØ±ÛŒâ€ŒÙ‡Ø§ -->
  <div id="storyPanel" class="story-panel" aria-hidden="true">
    <div class="stories" role="list"></div>
    <button class="go-pagination" type="button">
      go to pagination 
      <img src="images/icons8-double-down.apng" alt="down" style="width:16px;height:16px;vertical-align:middle;"/>
    </button>
  </div>

  <!-- Ø¯Ú©Ù…Ù‡ Ø´Ù†Ø§ÙˆØ± -->
  <div id="storyToggle" class="floating-btn" aria-label="toggle stories">
    <img id="storyToggleIcon" src="images/icons8-double-left.apng" alt="toggle"/>
  </div>
</div>
<!-- script (app logic) -->
<script src="script.js"></script>
</body>
